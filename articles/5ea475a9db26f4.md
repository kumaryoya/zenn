---
title: "ã€Railsã€‘Google API ã‚’ä½¿ã£ãŸã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆã¸ã®ãƒ‡ãƒ¼ã‚¿æ›¸ãè¾¼ã¿æ–¹æ³•ã‚’åˆ†ã‹ã‚Šã‚„ã™ãè§£èª¬ã—ã¦ã¿ãŸ"
emoji: "ğŸ“‘"
type: "tech"
topics: [ruby, rails, google, api, googlesheets]
published: false
publication_name: "linkedge"
---

## ã¯ã˜ã‚ã«

Rails ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã§ã¯ã€ãƒ‡ãƒ¼ã‚¿ã‚’ CSV ãƒ•ã‚¡ã‚¤ãƒ«ã¨ã—ã¦å‡ºåŠ›ã™ã‚‹æ©Ÿèƒ½ãŒã€ä¸€èˆ¬çš„ã«ã‚ˆãå®Ÿè£…ã•ã‚Œã¾ã™ã€‚
ç‰¹ã«ã€ãƒ¬ãƒãƒ¼ãƒˆæ©Ÿèƒ½ã‚’å‚™ãˆãŸã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã§ã¯ã€CSV å½¢å¼ã§ã®ãƒ‡ãƒ¼ã‚¿å‡ºåŠ›ã¯æ¬ ã‹ã›ã¾ã›ã‚“ã€‚

ã—ã‹ã—ã€ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã—ãŸ CSV ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ãã®ã¾ã¾ä½¿ç”¨ã™ã‚‹ãƒ¦ãƒ¼ã‚¶ãƒ¼ã¯å°‘ãªã„ã‹ã‚‚ã—ã‚Œã¾ã›ã‚“ã€‚
å®Ÿéš›ã«ã¯ã€ä»¥ä¸‹ã®ã‚ˆã†ãªæµã‚Œã§ä½œæ¥­ã‚’é€²ã‚ã‚‹ã‚±ãƒ¼ã‚¹ãŒå¤šã„ã§ã—ã‚‡ã†ã€‚

1. ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‹ã‚‰ CSV ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰
2. ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã—ãŸ CSV ãƒ•ã‚¡ã‚¤ãƒ«ã‚’é–‹ã
3. å¿…è¦ãªãƒ‡ãƒ¼ã‚¿ã‚’ CSV ãƒ•ã‚¡ã‚¤ãƒ«ã‹ã‚‰ã‚³ãƒ”ãƒ¼ã™ã‚‹
4. é–¢æ•°ã‚’çµ„ã¿è¾¼ã‚“ã  Excel ãƒ•ã‚¡ã‚¤ãƒ«ã«ãƒ‡ãƒ¼ã‚¿ã‚’è²¼ã‚Šä»˜ã‘ã‚‹
5. ãƒ‡ãƒ¼ã‚¿ã‚’ã‚‚ã¨ã«ã‚°ãƒ©ãƒ•ã‚’ä½œæˆã—ãŸã‚Šã€é›†è¨ˆã‚’è¡Œã†

![](https://storage.googleapis.com/zenn-user-upload/7c00c87d3b45-20250308.png =400x)

ã“ã®ä½œæ¥­è‡ªä½“ã¯ãã‚Œã»ã©æ™‚é–“ãŒã‹ã‹ã‚‹ã‚‚ã®ã§ã¯ã‚ã‚Šã¾ã›ã‚“ãŒã€æ¯æ—¥ç¹°ã‚Šè¿”ã™ã¨ãªã‚‹ã¨æ‰‹é–“ã«ãªã‚Šã¾ã™ã€‚
ã—ã‹ã—ã€ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã«ã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆã¸ç›´æ¥ãƒ‡ãƒ¼ã‚¿ã‚’æ›¸ãè¾¼ã‚€æ©Ÿèƒ½ã‚’è¿½åŠ ã™ã‚Œã°ã€**ã‚¹ãƒ†ãƒƒãƒ— 1 ~ 4 ã‚’çœç•¥ã§ãã€ã™ãã«ã‚¹ãƒ†ãƒƒãƒ— 5 ã®ä½œæ¥­ã«å–ã‚Šæ›ã‹ã‚Œã¾ã™ã€‚**

![](https://storage.googleapis.com/zenn-user-upload/9c493a53cb46-20250308.png =300x)

ãã“ã§æœ¬è¨˜äº‹ã§ã¯ã€**Rails ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‹ã‚‰ Google API ã‚’ä½¿ã£ã¦ã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆã¸ãƒ‡ãƒ¼ã‚¿ã‚’æ›¸ãè¾¼ã‚€æ–¹æ³•**ã‚’åˆ†ã‹ã‚Šã‚„ã™ãè§£èª¬ã—ã¾ã™ã€‚

å®Ÿè£…è‡ªä½“ã¯ãã‚Œã»ã©é›£ã—ãã‚ã‚Šã¾ã›ã‚“ãŒã€æ‰‹é †ãŒæ•´ç†ã•ã‚Œã¦ã„ã‚‹æ–¹ãŒã‚¹ãƒ ãƒ¼ã‚ºã«é€²ã‚ã‚‰ã‚Œã‚‹ã¯ãšã§ã™ã€‚

åŒã˜ã‚ˆã†ãªæ©Ÿèƒ½ã‚’å®Ÿè£…ã—ãŸã„ã¨è€ƒãˆã¦ã„ã‚‹æ–¹ã«ã¨ã£ã¦ã€å°‘ã—ã§ã‚‚å‚è€ƒã«ãªã‚Œã°å¹¸ã„ã§ã™ã€‚

ãœã²æœ€å¾Œã¾ã§ã”è¦§ãã ã•ã„ã€‚

## æ³¨æ„ç‚¹

:::message alert
- å†…å®¹ã«èª¤ã‚ŠãŒå«ã¾ã‚Œã¦ã„ã‚‹å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ã€‚
- ã‚³ãƒ¡ãƒ³ãƒˆç­‰ã§ã”æŒ‡æ‘˜ã„ãŸã ã‘ã¾ã™ã¨å¹¸ã„ã§ã™ã€‚
:::

## ç’°å¢ƒ

æœ¬è¨˜äº‹ã§ä½¿ç”¨ã™ã‚‹ç’°å¢ƒã¯ä»¥ä¸‹ã®é€šã‚Šã§ã™ã€‚

:::message
ä½¿ç”¨ç’°å¢ƒ
- **Docker Desktop**ï¼š4.39.0
- **Docker Engine**ï¼š28.0.1
- **Ruby**ï¼š3.3.5
- **Rails**ï¼š7.0.8.6
:::

## å‰æ

æœ¬è¨˜äº‹ã§ä½¿ç”¨ã™ã‚‹ Rails ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã¯ã€ä»¥ä¸‹ã®æ§‹æˆã‚’å‰æã¨ã—ã¾ã™ã€‚

```ruby:db/schema.rb
ActiveRecord::Schema[7.0].define(version: 2024_12_21_083443) do
  create_table "posts", charset: "utf8mb4", collation: "utf8mb4_0900_ai_ci", force: :cascade do |t|
    t.bigint "user_id", null: false
    t.string "title", null: false
    t.text "content", null: false
    t.datetime "created_at", null: false
    t.datetime "updated_at", null: false
    t.index ["user_id"], name: "index_posts_on_user_id"
  end

  create_table "users", charset: "utf8mb4", collation: "utf8mb4_0900_ai_ci", force: :cascade do |t|
    t.string "name", null: false
    t.string "email", null: false
    t.integer "age", null: false
    t.string "login_id", null: false
    t.string "encrypted_password", null: false
    t.datetime "created_at", null: false
    t.datetime "updated_at", null: false
    t.index ["email"], name: "index_users_on_email", unique: true
    t.index ["login_id"], name: "index_users_on_login_id", unique: true
  end

  add_foreign_key "posts", "users"
end
```

```ruby:app/models/user.rb
class User < ApplicationRecord
  has_many :posts, dependent: :destroy
end
```

```ruby:app/models/post.rb
class Post < ApplicationRecord
  belongs_to :user
end
```

```ruby:app/controllers/posts_controller.rb
class PostsController < ApplicationController
  before_action :set_post, only: %i[show edit update destroy]

  def index
    @posts = current_user.posts.order(id: :desc)
  end

  def show; end

  def new
    @post = current_user.posts.new
  end

  def edit; end

  def create
    @post = current_user.posts.new(post_params)

    if @post.save
      redirect_to root_path, notice: 'Post was successfully created.'
    else
      render :new
    end
  end

  def update
    if @post.update(post_params)
      redirect_to root_path, notice: 'Post was successfully updated.'
    else
      render :edit
    end
  end

  def destroy
    @post.destroy
    redirect_to root_path, notice: 'Post was successfully destroyed.'
  end

  private

  def post_params
    params.require(:post).permit(:title, :content)
  end

  def set_post
    @post = current_user.posts.find(params[:id])
  end
end
```

![](https://storage.googleapis.com/zenn-user-upload/b181ff090174-20250308.png =1000x)
*æŠ•ç¨¿ä¸€è¦§ç”»é¢*

ã“ã® Rails ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã¯ã€ä¸€èˆ¬çš„ãªæ§‹æˆã«ãªã£ã¦ã„ã¾ã™ã€‚
User ã¨ Post ã¯ 1 å¯¾å¤šã®é–¢ä¿‚ã§ã€åŸºæœ¬çš„ãª CRUD æ©Ÿèƒ½ã‚’å‚™ãˆã¦ã„ã¾ã™ã€‚
ã¾ãŸã€ä¸€è¦§ç”»é¢ã«ã¯ãƒ­ã‚°ã‚¤ãƒ³ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒæŠ•ç¨¿ã—ãŸè¨˜äº‹ã®ã¿ãŒè¡¨ç¤ºã•ã‚Œã¾ã™ã€‚

## Google API ã«ã¤ã„ã¦

ã¾ãšã€Google API ã«ã¤ã„ã¦ç°¡å˜ã«è§£èª¬ã—ã¾ã™ã€‚
Google API ã¯ã€Google ãŒæä¾›ã™ã‚‹ã•ã¾ã–ã¾ãªã‚µãƒ¼ãƒ“ã‚¹ã‚’åˆ©ç”¨ã§ãã‚‹ API ã§ã™ã€‚
ä¾‹ãˆã°ã€ã€ŒMaps JavaScript APIã€ã€ŒCloud Vision APIã€ã€ŒGmail APIã€ãªã©ã€å¤šæ§˜ãª API ãŒæä¾›ã•ã‚Œã¦ã„ã¾ã™ã€‚

https://console.cloud.google.com/apis/library

Google API ã«ã¯ã€ã€ŒJavaã€ã€ŒPythonã€ã€ŒPHPã€ãªã©ã€ã•ã¾ã–ã¾ãªãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°è¨€èªå‘ã‘ã®ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆãƒ©ã‚¤ãƒ–ãƒ©ãƒªãŒæä¾›ã•ã‚Œã¦ã„ã¾ã™ã€‚

https://developers.google.com/api-client-library

Ruby å‘ã‘ã®ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚‚æä¾›ã•ã‚Œã¦ãŠã‚Šã€`google-api-client` ã¨ã„ã† gem ã‚’ä½¿ã†ã“ã¨ã§ã€ç°¡å˜ã« Google API ã‚’åˆ©ç”¨ã§ãã¾ã™ã€‚

https://developers.google.com/sheets/api/guides/libraries#ruby

https://github.com/googleapis/google-api-ruby-client

https://rubygems.org/gems/google-api-client
