---
title: "【Rails】Action Cable で簡単にリアルタイム機能を実装する"
emoji: "🔌"
type: "tech"
topics: [ruby, rails, javascript, actioncable, websocket]
published: false
publication_name: "linkedge"
---

## はじめに

Rails に搭載されている機能のうちの1つに Action Cable があります。

何度か使ってみたことはあるものの、あまり深く理解していなかったので、改めて Action Cable について学んでみました。

できるだけ分かりやすく Action Cable についてまとめてみましたので、少しでも皆様の参考になりますと幸いです。

![](https://storage.googleapis.com/zenn-user-upload/21721ff3e360-20250822.jpeg =300x)

## 注意点

:::message alert
- 内容に誤りが含まれている可能性があります
- コメントなどでご指摘いただけると幸いです
:::

## 環境

:::message
- Docker Desktop：4.44.3
- Docker Engine：28.3.2
- Ruby：3.3.5
- Rails：7.0.8.6
:::

## Action Cable とは

Action Cable とは、Rails に搭載されている機能の1つです。

Action Cable はフルスタックのフレームワークで、クライアント側の JavaScript フレームワークと、サーバー側の Ruby フレームワークを提供します。

Action Cable を使用することで、簡単に WebSocket を Rails アプリケーションに導入し、リアルタイム機能を実装することができます。

https://railsguides.jp/action_cable_overview.html

## WebSocket とは

WebSocket とは、クライアントとサーバー間で1度接続を確立すると、リアルタイムで双方向の通信を可能にするプロトコルのことです。

HTTP のように、リクエストごとに接続を確立する必要がなく、効率的なデータの送受信が可能となっており、リアルタイム性が求められるアプリケーション開発に活用されています。

:::message
- リアルタイム性が求められるアプリケーションの例
  - チャットアプリ
  - オンラインゲーム
  - Canva や Google スライドなどの共同編集ツール
:::

![](https://storage.googleapis.com/zenn-user-upload/834fb69cd571-20250823.png =1000x)

## 用語

Action Cable、WebSocket を学ぶ上で、理解しておくべき用語が6つあります。

### コネクション

- コネクション（connection）は、クライアントとサーバーを繋ぐもの
- 1つのコネクションは、1つのコネクションインスタンスを持っている
- 1つの Action Cable サーバーは、複数のコネクションインスタンス持つことができる
- あるユーザーがブラウザタブを複数開いたり、複数のデバイスを用いている場合、それぞれにコネクションがオープンされる

### コンシューマー

- WebSocket コネクションのクライアントは、コンシューマー（consumer）と呼ばれる
- Action Cable のコンシューマーは、クライアント側の JavaScript フレームワークによって作成される

### チャネル

- コンシューマーごとに、複数のチャネル（channel）をサブスクライブすることができる
- 1つのコンシューマーが、「チャットチャネル」「ゲームチャネル」のように複数のチャネルをサブスクライブすることができる
- 各チャネルは、機能単位で、カプセル化されており、チャネル内では「送られてきたデータを処理する」「必要なデータを返す」のように Rails の Controller と同じことが行われている

### サブスクライバ

- コンシューマーがチャネルでサブスクライブされると、サブスクライバ（subscriber）として振る舞う
- サブスクライバとチャネルの間のコネクションは、サブスクリプションと呼ばれる

### Pub/Sub

- Pub/Sub は、Publish-Subscribe の略
- Pub/Sub は、情報の送り手（パブリッシャー）と受け手（サブスクライバー）を直接つなげない、柔軟なやり取りの仕組み
- メールのように送り手を指定するのではなく、Pub/Sub は、送り手がトピックと呼ばれる特定のテーマに対して情報を送信し、そのトピックをサブスクライブしているすべての受け手に配信される
- Action Cable では、この Pub/Sub を用いてサーバーと多数のクライアントの間の通信を行う

### ブロードキャスト
- ブロードキャストは、Pub/Sub の考え方に基づいた、特定のチャネルに接続しているすべてのクライアントに一斉に情報を送信する仕組み
- 情報の送り手をブロードキャスターと呼ぶ
- チャネルは複数のブロードキャストをストリーミングできる
  - ブロードキャスト：情報を送信する仕組み
  - ストリーミング：データを転送する方式

## 参考文献

https://railsguides.jp/action_cable_overview.html

https://shukapin.com/infographicIT/websocket
