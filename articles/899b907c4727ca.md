---
title: "ã€GASã€‘ç‰¹å®šã®ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ã§æ¤œç´¢ã™ã‚‹ã¨è¡¨ç¤ºã•ã‚Œã‚‹Webã‚µã‚¤ãƒˆã‚’ã‚¹ãƒ—ã‚·ã«æ›¸ãå‡ºã™"
emoji: "ğŸ”"
type: "tech"
topics: [web, gas, googleã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆ, customsearchapi, programmablesearchengine]
published: false
publication_name: "linkedge"
---

## ã¯ã˜ã‚ã«

ãŠç–²ã‚Œæ§˜ã§ã™ã€‚
ãŠãŠãã¾ã§ã™ã€‚

ä»Šå›ã¯ã€ã€Œã€GASã€‘ç‰¹å®šã®ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ã§æ¤œç´¢ã™ã‚‹ã¨è¡¨ç¤ºã•ã‚Œã‚‹Webã‚µã‚¤ãƒˆã‚’ã‚¹ãƒ—ã‚·ã«æ›¸ãå‡ºã™ã€ã¨ã„ã†ã“ã¨ã§ã€**GAS**ã‚„**CustomSearchAPI**ã€**ProgrammableSearchEngine**ã«ã¤ã„ã¦ã¾ã¨ã‚ã¦ã¿ã¾ã—ãŸã€‚

å°‘ã—ã§ã‚‚çš†æ§˜ã®å‚è€ƒã«ãªã‚Šã¾ã™ã¨å¹¸ã„ã§ã™ã€‚

## å¯¾è±¡èª­è€…

:::message
- **GAS**ã«ã¤ã„ã¦èˆˆå‘³ã®ã‚ã‚‹æ–¹
- **CustomSearchAPI**ã«ã¤ã„ã¦èˆˆå‘³ã®ã‚ã‚‹æ–¹
- **ProgrammableSearchEngine**ã«ã¤ã„ã¦èˆˆå‘³ã®ã‚ã‚‹æ–¹
:::

## æ³¨æ„ç‚¹

:::message alert
å†…å®¹ã«èª¤ã‚ŠãŒã‚ã‚‹å ´åˆãŒã‚ã‚Šã¾ã™ã€‚
ã‚³ãƒ¡ãƒ³ãƒˆç­‰ã§æ•™ãˆã¦ã„ãŸã ã‘ã‚‹ã¨å¹¸ç”šã§ã™ã€‚
:::

## GASã¨ã¯
**GAS**ã¨ã¯ã€**GoogleAppsScript**ã®ç•¥ã§ã€**Google**ã«ã‚ˆã£ã¦é–‹ç™ºã•ã‚ŒãŸã‚¹ã‚¯ãƒªãƒ—ãƒˆãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ ã§ã™ã€‚
**Google**ãŒæä¾›ã™ã‚‹å„ç¨®ã‚µãƒ¼ãƒ“ã‚¹ã®è‡ªå‹•åŒ–ã‚„é€£æºã‚’è¡Œã†ãŸã‚ã®ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚’é–‹ç™ºã™ã‚‹ãŸã‚ã®ãƒ„ãƒ¼ãƒ«ã¨ã—ã¦æ´»ç”¨ã•ã‚Œã¾ã™ã€‚
**GAS**ã§ä½¿ç”¨ã™ã‚‹ã‚¹ã‚¯ãƒªãƒ—ãƒˆè¨€èªã¯ã€**JavaScript**ã‚’ãƒ™ãƒ¼ã‚¹ã«ä½œã‚‰ã‚Œã¦ã„ã¾ã™ã€‚
åŸºæœ¬çš„ãªæ–‡æ³•ã¯**JavaScript**ã¨åŒã˜ãªã®ã§ã€**JavaScript**ã‚’ä½¿ã£ãŸã“ã¨ã®ã‚ã‚‹æ–¹ã§ã‚ã‚Œã°æ¯”è¼ƒçš„ç°¡å˜ã«ä½¿ã„ã“ãªã›ã‚‹ã¨æ€ã„ã¾ã™ã€‚

https://satori.marketing/marketing-blog/gas-introduction/

å¼Šç¤¾ã§ã‚‚**GAS**ã‚’ä½¿ç”¨ã—ã¦ã€æ§˜ã€…ãªæ¥­å‹™ã®è‡ªå‹•åŒ–ãƒ»åŠ¹ç‡åŒ–ã‚’è¡Œã£ã¦ã„ã¾ã™ã€‚

## CustomSearchAPIã¨ã¯
**CustomSearchAPI**ã¨ã¯ã€**Google**ãŒæä¾›ã™ã‚‹æ¤œç´¢ã‚¨ãƒ³ã‚¸ãƒ³ã®APIã§ã™ã€‚
**CustomSearchAPI**ã‚’ä½¿ç”¨ã™ã‚‹ã“ã¨ã§ã€ç‰¹å®šã®ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ã§æ¤œç´¢ã™ã‚‹ã¨è¡¨ç¤ºã•ã‚Œã‚‹Webã‚µã‚¤ãƒˆã‚’å–å¾—ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚

## ProgrammableSearchEngineã¨ã¯
**ProgrammableSearchEngine**ã¨ã¯ã€**Google**ãŒæä¾›ã™ã‚‹ã‚«ã‚¹ã‚¿ãƒ æ¤œç´¢ã‚¨ãƒ³ã‚¸ãƒ³ã§ã™ã€‚
**ProgrammableSearchEngine**ã‚’ä½¿ç”¨ã™ã‚‹ã“ã¨ã§ã€ç‰¹å®šã®ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ã§æ¤œç´¢ã™ã‚‹ã¨è¡¨ç¤ºã•ã‚Œã‚‹Webã‚µã‚¤ãƒˆã‚’ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚ºã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚

## å®Ÿè·µ
ã§ã¯ã€å®Ÿéš›ã«**GAS**ã‚’ä½¿ç”¨ã—ã¦ã€ç‰¹å®šã®ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ã§æ¤œç´¢ã™ã‚‹ã¨è¡¨ç¤ºã•ã‚Œã‚‹Webã‚µã‚¤ãƒˆã‚’ã‚¹ãƒ—ã‚·ã«æ›¸ãå‡ºã™ã‚ˆã†ã«å®Ÿè£…ã—ã¦ã¿ã¾ã—ã‚‡ã†ã€‚

### 1. **CustomSearchAPI**ã¨**ProgrammableSearchEngine**ã®è¨­å®š
ã¾ãšã¯ã€**CustomSearchAPI**ã¨**ProgrammableSearchEngine**ã®è¨­å®šã‚’è¡Œã„ã¾ã™ã€‚
ä»¥ä¸‹ã®è¨˜äº‹ã‚’å‚è€ƒã«è¨­å®šã‚’è¡Œã„ã€**CustomSearchAPI**ã®APIã‚­ãƒ¼ã¨ã€**ProgrammableSearchEngine**ã®ã‚«ã‚¹ã‚¿ãƒ æ¤œç´¢ã‚¨ãƒ³ã‚¸ãƒ³IDã‚’å–å¾—ã—ã¦ãã ã•ã„ã€‚

https://qiita.com/zak_y/items/42ca0f1ea14f7046108c

https://zenn.dev/yyoshioka/articles/fa0e0a8cc480b6

### 2. **Googleã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆ**ã®ä½œæˆ
æ¬¡ã«ã€**Googleã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆ**ã‚’ä½œæˆã—ã¾ã™ã€‚
ä»Šå›ã¯ã€ä»¥ä¸‹ã®ã‚ˆã†ãªã‚·ãƒ¼ãƒˆã‚’ä½œæˆã—ã¾ã—ãŸã€‚

![](https://storage.googleapis.com/zenn-user-upload/3d9b24d2c15b-20240530.png)

### 3. **GAS**ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®ä½œæˆ
ã¾ãšã¯ã€**GAS**ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’ä½œæˆã—ã¾ã™ã€‚
ã‚³ãƒ¼ãƒ‰ã¯ã‚µã‚¯ãƒƒã¨ChatGPTã«æ›¸ã„ã¦ã‚‚ã‚‰ã„ã¾ã—ãŸã€‚

```javascript
function getGoogleSearchResults() {
  // Google Custom Search APIã®APIã‚­ãƒ¼ã‚’å…¥åŠ›
  const apiKey = '**********';
  // ã‚«ã‚¹ã‚¿ãƒ æ¤œç´¢ã‚¨ãƒ³ã‚¸ãƒ³IDã‚’å…¥åŠ›
  const searchEngineId = '**********';
  // æ¤œç´¢ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ã‚’å…¥åŠ›
  const keyword = 'ãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°';
  // APIãƒªã‚¯ã‚¨ã‚¹ãƒˆURLã‚’ä½œæˆ
  const apiUrl = `https://www.googleapis.com/customsearch/v1?q=${encodeURIComponent(keyword)}&cx=${searchEngineId}&key=${apiKey}`;

  // Google Sheetsã®IDã‚’å…¥åŠ›
  const spreadsheetId = '**********';
  // ã‚ªãƒªã‚¸ãƒŠãƒ«ã®ã‚·ãƒ¼ãƒˆå
  const originalSheetName = 'ã€åŸæœ¬ã€‘';

  try {
    // APIãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’é€ä¿¡
    const response = UrlFetchApp.fetch(apiUrl);
    const data = JSON.parse(response.getContentText());

    // Google Sheetsã‚’å–å¾—
    const spreadsheet = SpreadsheetApp.openById(spreadsheetId);

    // ç¾åœ¨ã®æ—¥ä»˜ã‚’å–å¾—ã—ã¦ã‚·ãƒ¼ãƒˆåã‚’ä½œæˆ
    const now = new Date();
    const formattedDate = Utilities.formatDate(now, Session.getScriptTimeZone(), 'yyyy/MM/dd');
    const newSheetName = formattedDate;

    // å…ƒã®ã‚·ãƒ¼ãƒˆã‚’ã‚³ãƒ”ãƒ¼ã—ã¦æ–°ã—ã„ã‚·ãƒ¼ãƒˆã‚’ä½œæˆã€æ—¢ã«å­˜åœ¨ã™ã‚‹å ´åˆã¯å‰Šé™¤ã—ã¦å†ä½œæˆ
    let sheet = spreadsheet.getSheetByName(newSheetName);
    if (sheet) {
      spreadsheet.deleteSheet(sheet);
    }
    const originalSheet = spreadsheet.getSheetByName(originalSheetName);
    if (originalSheet) {
      sheet = originalSheet.copyTo(spreadsheet).setName(newSheetName);
    } else {
      throw new Error(`Sheet "${originalSheetName}" not found.`);
    }

    // ã‚·ãƒ¼ãƒˆã®ç¯„å›²ã‚’ã‚¯ãƒªã‚¢ï¼ˆå¿…è¦ã«å¿œã˜ã¦ï¼‰
    sheet.getRange('C5:D').clearContent();

    // æ¤œç´¢çµæœãƒˆãƒƒãƒ—10ã‚’ã‚·ãƒ¼ãƒˆã«æ›¸ãè¾¼ã‚€
    if (data.items && data.items.length > 0) {
      const results = data.items.slice(0, 10);
      results.forEach((result, index) => {
        sheet.getRange(5 + index, 3).setValue(result.title); // Cåˆ—ã«ã‚¿ã‚¤ãƒˆãƒ«
        sheet.getRange(5 + index, 4).setValue(result.link);  // Dåˆ—ã«ãƒªãƒ³ã‚¯
      });
    } else {
      Logger.log('No search results found.');
    }

    // æ›´æ–°æ™‚é–“ã‚’B2ã«è¨˜å…¥
    const formattedDateTime = Utilities.formatDate(now, Session.getScriptTimeZone(), 'yyyy/MM/dd HH:mm:ss');
    sheet.getRange('B2').setValue(`æ›´æ–°æ™‚é–“ï¼š${formattedDateTime}`);
  } catch (e) {
    Logger.log(`Error: ${e.message}`);
  }
}
```

### 4. å®Ÿè¡Œçµæœ
å®Ÿè¡Œçµæœã¯ä»¥ä¸‹ã®ã‚ˆã†ã«ãªã‚Šã¾ã—ãŸã€‚

![](https://storage.googleapis.com/zenn-user-upload/4778a069ae2c-20240606.png)

## æœ€å¾Œã«
ä»Šå›ã¯ã€**CustomSearchAPI**ã¨**ProgrammableSearchEngine**ã‚’ç”¨ã„ã¦**GAS**ã®ä½¿ç”¨ä¾‹ã‚’ã”ç´¹ä»‹ã—ã¾ã—ãŸãŒã€ä»–ã«ã‚‚æ§˜ã€…ãªæ´»ç”¨æ–¹æ³•ãŒ**GAS**ã«ã¯ã‚ã‚Šã¾ã™ã€‚
ã¨ã¦ã‚‚ä¾¿åˆ©ãªãƒ„ãƒ¼ãƒ«ã§ã™ã®ã§ã€ãœã²æ´»ç”¨ã—ã¦ã¿ã¦ãã ã•ã„ã€‚
æœ€å¾Œã¾ã§èª­ã‚“ã§ã„ãŸã ãã‚ã‚ŠãŒã¨ã†ã”ã–ã„ã¾ã—ãŸã€‚
